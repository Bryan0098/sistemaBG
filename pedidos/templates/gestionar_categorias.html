{% extends 'base.html' %}

{% block title %}Gestionar Categorías - Portal{% endblock %}

{% block content %}
<h1>Gestionar Categorías</h1>

<!-- Mensajes de éxito o error -->
{% if messages %}
    <ul>
        {% for message in messages %}
            <li>{{ message }}</li>
        {% endfor %}
    </ul>
{% endif %}

<!-- Formulario para Crear Categoría -->
<h2>Crear Categoría</h2>
<form method="POST">
    {% csrf_token %}
    <label for="nombre">Nombre</label>
    <input type="text" id="nombre" name="nombre" required><br>

    <label for="descripcion">Descripción</label>
    <textarea id="descripcion" name="descripcion" required></textarea><br>

    <button type="submit" name="crear">Crear Categoría</button>
</form>

<hr>

<!-- Lista de Categorías -->
<h2>Lista de Categorías</h2>
<ul>
    {% for categoria in categorias %}
        <li>
            {{ categoria.nombre }} - {{ categoria.descripcion }}
            
            <!-- Formulario para Actualizar Categoría -->
            <button onclick="document.getElementById('update-form-{{ categoria.id_categoria }}').style.display = 'block'">Editar</button>
            <form id="update-form-{{ categoria.id_categoria }}" method="POST" style="display:none;">
                {% csrf_token %}
                <input type="hidden" name="id_categoria" value="{{ categoria.id_categoria }}">
                <input type="text" name="nombre" value="{{ categoria.nombre }}" required><br>
                <textarea name="descripcion" required>{{ categoria.descripcion }}</textarea><br>
                <button type="submit" name="actualizar">Actualizar Categoría</button>
            </form>

            <!-- Formulario para Eliminar Categoría -->
            <form method="POST" style="display:inline;">
                {% csrf_token %}
                <input type="hidden" name="id_categoria" value="{{ categoria.id_categoria }}">
                <button type="submit" name="eliminar" onclick="return confirm('¿Estás seguro de eliminar esta categoría?')">Eliminar</button>
            </form>
        </li>
    {% endfor %}
</ul>
{% endblock %}
